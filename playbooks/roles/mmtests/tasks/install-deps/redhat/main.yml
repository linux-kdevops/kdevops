---
- name: Import optional extra_args file
  ansible.builtin.include_vars: "{{ item }}"
  ignore_errors: true
  with_first_found:
    - files:
        - "../extra_vars.yml"
        - "../extra_vars.yaml"
        - "../extra_vars.json"
      skip: true
  tags: vars

- name: Install mmtests build dependencies (RedHat/CentOS)
  become: true
  become_method: sudo
  ansible.builtin.dnf:
    name:
      - gcc
      - git
      - perl
      - perl-CPAN
      - perl-Math-Gradient
      - R
      - R-devel
      - libnuma-devel
      - perl-Math-Gradient
    state: present
  tags: ["deps"]

- name: Install mmtests runtime dependencies (RedHat/CentOS)
  become: true
  become_method: sudo
  ansible.builtin.dnf:
    name:
      - numactl
      - fio
      - sysstat
      - procps-ng
      - util-linux
      - coreutils
      - time
      - bc
      - psmisc
    state: present
  tags: ["deps"]

- name: Install mmtests monitoring dependencies (RedHat/CentOS)
  become: true
  become_method: sudo
  ansible.builtin.dnf:
    name:
      - kernel-tools
      - trace-cmd
      - perf
      - python3-bcc
    state: present
  tags: ["deps"]
  ignore_errors: true
