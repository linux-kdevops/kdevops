# Azure VM Size Selection
# This file is auto-generated. Do not edit manually.
# Generated by: terraform/azure/scripts/gen_kconfig_size

choice
	prompt "VM size family"
	default {{ default_family_config }}
	help
	  Select the Azure VM size family for your target nodes.
	  Each family is optimized for different workloads.

	  VM size availability varies by region. You can verify
	  available VM sizes for your region using:

	    az vm list-sizes --location <region> -o table

	  For detailed information about Azure VM families:

	    https://learn.microsoft.com/en-us/azure/virtual-machines/sizes/overview

{% for family in families %}
config TERRAFORM_AZURE_VM_FAMILY_{{ family.config_name }}
	bool "{{ family.family_name }} - {{ family.description }}"
{% if family.architecture == 'arm64' %}
	depends on TARGET_ARCH_ARM64
{% else %}
	depends on TARGET_ARCH_X86_64
{% endif %}
	help
	  {{ family.help_text | replace('\n', '\n\t  ') }}

	  This family contains {{ family.size_count }} VM size{{ 's' if family.size_count > 1 else '' }}:
	  - CPU cores: {{ family.min_cores }}-{{ family.max_cores }}
	  - Memory: {{ family.min_memory_gb|round(1) }}-{{ family.max_memory_gb|round(1) }}GB

{% endfor %}
endchoice

{% for family in families %}
if TERRAFORM_AZURE_VM_FAMILY_{{ family.config_name }}

choice
	prompt "{{ family.family_name }} VM size"
	default {{ family.default_size_config }}
	help
	  Select a specific VM size from the {{ family.family_name }} family.

{% for size in family.sizes %}
config TERRAFORM_AZURE_VM_SIZE_{{ size.config_name }}
	bool "{{ size.name }}"
	help
	  This virtual machine size has {{ size.cores }} vCPU{{ 's' if size.cores > 1 else '' }} and {{ size.memory_gb|round(1) }}GB of memory.
{% if size.resource_disk_gb > 0 %}
	  Includes {{ size.resource_disk_gb|round(1) }}GB temporary storage.
{% endif %}
	  Supports up to {{ size.max_data_disks }} data disk{{ 's' if size.max_data_disks > 1 else '' }}.

{% endfor %}
endchoice

endif # TERRAFORM_AZURE_VM_FAMILY_{{ family.config_name }}

{% endfor %}

config TERRAFORM_AZURE_VM_SIZE
	string
	output yaml
{% for family in families %}
{% for size in family.sizes %}
	default "{{ size.name }}" if TERRAFORM_AZURE_VM_SIZE_{{ size.config_name }}
{% endfor %}
{% endfor %}

config TERRAFORM_AZURE_ACCELERATED_NETWORKING_ENABLED
	bool
	output yaml
{% for family in families %}
{% for size in family.sizes %}
	default {{ 'y' if size.accelerated_networking else 'n' }} if TERRAFORM_AZURE_VM_SIZE_{{ size.config_name }}
{% endfor %}
{% endfor %}
