if TERRAFORM

menu "Terraform cloud provider configuration"
source "terraform/Kconfig.providers"
endmenu

menu "Terraform ssh configuration"
source "terraform/Kconfig.ssh"
endmenu

config TERRAFORM_PRIVATE_NET
	bool "Add a private network for the guests"
	depends on TERRAFORM_AZURE
	default y
	help
	  This option adds a private network between the various guests
	  on a separate interface from the public network. This is useful
	  if you want to run a workflow that involves communications
	  between the guests. The guests will determine their IPv4 address
	  via DHCP.

config TERRAFORM_PRIVATE_NET_PREFIX
	string "Network prefix for private network"
	default "10.0.3.0"
	depends on TERRAFORM_PRIVATE_NET
	help
	  Network prefix of the private network. It's recommended to use
	  RFC1918 addresses or something that won't conflict with
	  globally-routable addresses.

config TERRAFORM_PRIVATE_NET_MASK
	int "Network mask for private network"
	default 24
	depends on TERRAFORM_PRIVATE_NET
	help
	  Length of the network mask to use for the private network.

choice
	prompt "Infrastructure as Code tool"
	default TERRAFORM_USE_TERRAFORM
	help
	  Choose whether to use Terraform or OpenTofu for infrastructure
	  provisioning. OpenTofu is an open-source fork of Terraform that
	  maintains compatibility with Terraform configurations.

config TERRAFORM_USE_TERRAFORM
	bool "Use Terraform"
	output yaml
	help
	  Use HashiCorp Terraform for infrastructure provisioning.
	  Terraform is the original infrastructure as code tool.

config TERRAFORM_USE_OPENTOFU
	bool "Use OpenTofu"
	output yaml
	help
	  Use OpenTofu for infrastructure provisioning. OpenTofu is an
	  open-source fork of Terraform maintained by the Linux Foundation
	  that provides a community-driven alternative while maintaining
	  compatibility with Terraform configurations.

endchoice

config TERRAFORM_BINARY_PATH
	string "Path to Terraform or OpenTofu binary"
	default "/usr/bin/terraform" if TERRAFORM_USE_TERRAFORM
	default "/usr/local/bin/tofu" if TERRAFORM_USE_OPENTOFU
	output yaml
	help
	  Specify the path to the Terraform or OpenTofu binary. The default
	  is set based on your Infrastructure as Code tool choice above.
	  Override this if your binary is installed in a different location,
	  such as /usr/bin/terraform or /usr/bin/tofu.

endif # TERRAFORM
